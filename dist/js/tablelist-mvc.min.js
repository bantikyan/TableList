function tableListExternalBind(){$(".table-list-mvc tr td > input.date-picker")[0]&&$(".table-list-mvc tr td > input.date-picker").datetimepicker({format:"MM/DD/YYYY"})}function initTableList(){var n=$(".table-list-mvc").closest("form"),t;typeof n!="undefined"&&typeof n.data("validator")!="undefined"&&(t=n.data("validator").settings.ignore,t.indexOf(".table-list-mvc")==-1&&(n.data("validator").settings.ignore=".table-list-mvc-ignore, "+t),$(n).submit(function(){if($(this).valid()){var n=$(this).find(".table-list-mvc > tbody > tr.table-list-mvc-item-new:last");$(n).each(function(){$(this).remove()})}return!0}),tableListBind())}function tableListBind(){$(".table-list-mvc > tbody > tr").unbind("click").bind("click",function(n){var r=n.target.tagName.toUpperCase(),i,t,u;r!="A"&&(i=$(n.target).closest("tr"),$(i).removeClass("table-list-mvc-item-view"),(r!="INPUT"||n.target.readOnly)&&(t=$(i).find("input:not([readonly]):first"),t.focus(),u=t.val(),t.val(""),t.val(u)))});$(".table-list-mvc tr:not(.table-list-mvc-item-new) td > input:not([readonly])").unbind("focusout").bind("focusout",function(){var n=$(this).closest("tr");n.hasClass("table-list-mvc-item-view")||n.addClass("table-list-mvc-item-view")});$(".table-list-mvc tr td > input").unbind("input").bind("input",function(){var n=$(this).closest("tr");n.hasClass("table-list-mvc-item-new")&&!$(this).hasClass("date-picker")&&tableListCloneRow($(n),$(this))});$(".table-list-mvc tr td > input").unbind("change").bind("change",function(n,t){var i=$(this).closest("tr"),r=i.find("input[name$='TL_State']");r.val()=="Default"&&r.val("Modified");el=$(this);i.hasClass("table-list-mvc-item-new")&&$(this).hasClass("date-picker")&&typeof t!="undefined"&&t&&setTimeout(function(){tableListCloneRow(i,el)},20);i.hasClass("table-list-mvc-item-new")&&$(this).is(":checkbox")&&tableListCloneRow(i,el)});$(".table-list-mvc tr td > input.date-picker").unbind("dp.change").bind("dp.change",function(n){var t=$(this).attr("dp.shown");typeof t!="undefined"&&parseInt(t)&&n.date!=n.oldDate&&$(this).trigger("change",1)});$(".table-list-mvc tr td > input.date-picker").unbind("dp.show").bind("dp.show",function(){$(this).attr("dp.shown",1)});$(".table-list-mvc input[data-group]").click(function(){var n="input[data-group='"+$(this).attr("data-group")+"']";$(n).prop("checked",!1);$(this).prop("checked",!0)});$(".table-list-mvc-item-delete").unbind("click").bind("click",function(n){n.preventDefault();var t=$(this).closest("tr"),r=t.closest(".table-list-mvc"),i=t.find("input[name$='TL_State']");i.val()=="Added"?(t.remove(),tableListRefresh(r),tableListBind()):(i.val("Deleted"),t.hide())});tableListExternalBind()}function tableListRefresh(n){var t=$(n).find("tbody tr");$(t).each(function(n){tableListRefreshItem(this,n)})}function tableListRefreshItem(n,t){var i=parseInt($(n).attr("data-item-index"));if(i!=t){$(n).attr("data-item-index",t);var r=new RegExp("\\["+i+"\\]","g"),u=new RegExp("_"+i+"__","g"),f=$(n).find("[name]"),e=$(n).find("[data-valmsg-for]");$(f).each(function(){$(this).attr("name",$(this).attr("name").replace(r,"["+t+"]"));typeof $(this).attr("id")!=typeof undefined&&$(this).attr("id")!==!1&&$(this).attr("id",$(this).attr("id").replace(u,"_"+t+"__"))});$(e).each(function(){$(this).attr("data-valmsg-for",$(this).attr("data-valmsg-for").replace(r,"["+t+"]"))})}}function tableListCloneRow(n,t){var f=parseInt(n.attr("data-item-index")),e=f+1,r,i,u;$(t).is(":checkbox")?(r=$(t).prop("checked"),$(t).prop("checked",!1)):(r=$(t).val(),$(t).val(""));i=$(t).attr("dp.shown");typeof i!="undefined"&&parseInt(i)&&$(t).attr("dp.shown",0);u=n.clone();u.appendTo(n.closest(".table-list-mvc").find("tbody"));tableListRefreshItem(u,e);n.removeClass("table-list-mvc-item-new");n.find(".table-list-mvc-ignore").removeClass("table-list-mvc-ignore");$(t).is(":checkbox")?$(t).prop("checked",r):$(t).val(r);typeof i!="undefined"&&parseInt(i)&&$(t).attr("dp.shown",1);tableListValidate(t);tableListBind()}function tableListValidate(n){var t=$(n).closest("form"),i;typeof t!="undefined"&&typeof t.data("validator")!="undefined"&&(t.removeData("validator"),t.removeData("unobtrusiveValidation"),$.validator.unobtrusive.parse(t),i=t.data("validator").settings.ignore,i.indexOf(".table-list-mvc")==-1&&(t.data("validator").settings.ignore=".table-list-mvc-ignore, "+i),t.validate())}$(function(){initTableList()});